<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- OAuth Success Template -->
    <template id="oauth_success" name="Zid OAuth Success">
        <t t-call="web.html_container">
            <t t-set="head">
                <title>Zid Integration - Connection Successful</title>
                <meta charset="utf-8"/>
                <meta name="viewport" content="width=device-width, initial-scale=1"/>
                <style>
                    body {
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        margin: 0;
                        padding: 0;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        min-height: 100vh;
                    }
                    .container {
                        background: white;
                        border-radius: 12px;
                        padding: 40px;
                        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                        text-align: center;
                        max-width: 500px;
                        margin: 20px;
                    }
                    .success-icon {
                        color: #28a745;
                        font-size: 64px;
                        margin-bottom: 20px;
                    }
                    h1 {
                        color: #333;
                        margin-bottom: 20px;
                        font-size: 28px;
                    }
                    .store-info {
                        background: #f8f9fa;
                        border-radius: 8px;
                        padding: 20px;
                        margin: 20px 0;
                        border-left: 4px solid #28a745;
                    }
                    .btn {
                        background: #007bff;
                        color: white;
                        padding: 12px 24px;
                        border: none;
                        border-radius: 6px;
                        cursor: pointer;
                        font-size: 16px;
                        margin: 10px;
                        text-decoration: none;
                        display: inline-block;
                    }
                    .btn:hover {
                        background: #0056b3;
                    }
                    .countdown {
                        color: #666;
                        font-size: 14px;
                        margin-top: 20px;
                    }
                </style>
            </t>

            <div class="container">
                <div class="success-icon">✅</div>
                <h1>Connection Successful!</h1>
                <p>Your Odoo system has been successfully connected to Zid.</p>

                <div class="store-info">
                    <h3>Store Information</h3>
                    <p><strong>Store Name:</strong> <span t-esc="store_name" t-if="store_name"/></p>
                    <p><strong>Integration:</strong> <span t-field="connector.app_name" t-if="connector and connector.app_name"/></p>
                    <p><strong>Connected at:</strong> <span t-field="connector.connection_date" t-if="connector and connector.connection_date" t-options="{'widget': 'datetime'}"/></p>
                </div>

                <p>You can now close this window and return to Odoo to manage your integration.</p>
                <button class="btn" onclick="window.close()">Close Window</button>

                <div class="countdown">
                    This window will automatically close in <span id="countdown">10</span> seconds.
                </div>
            </div>

            <script type="text/javascript">
                // Auto close window after 10 seconds
                let countdown = 10;
                const countdownElement = document.getElementById('countdown');

                const timer = setInterval(function() {
                    countdown--;
                    countdownElement.textContent = countdown;

                    if (countdown &lt;= 0) {
                        clearInterval(timer);
                        window.close();
                    }
                }, 1000);

                // Try to refresh parent window if possible
                try {
                    if (window.opener &amp;&amp; !window.opener.closed) {
                        window.opener.location.reload();
                    }
                } catch (e) {
                    console.log('Could not refresh parent window');
                }
            </script>
        </t>
    </template>

    <!-- OAuth Error Template -->
    <template id="oauth_error" name="Zid OAuth Error">
        <t t-call="web.html_container">
            <t t-set="head">
                <title>Zid Integration - Connection Error</title>
                <meta charset="utf-8"/>
                <meta name="viewport" content="width=device-width, initial-scale=1"/>
                <style>
                    body {
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
                        margin: 0;
                        padding: 0;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        min-height: 100vh;
                    }
                    .container {
                        background: white;
                        border-radius: 12px;
                        padding: 40px;
                        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                        text-align: center;
                        max-width: 500px;
                        margin: 20px;
                    }
                    .error-icon {
                        color: #dc3545;
                        font-size: 64px;
                        margin-bottom: 20px;
                    }
                    h1 {
                        color: #333;
                        margin-bottom: 20px;
                        font-size: 28px;
                    }
                    .error-details {
                        background: #f8d7da;
                        border-radius: 8px;
                        padding: 20px;
                        margin: 20px 0;
                        border-left: 4px solid #dc3545;
                        text-align: left;
                    }
                    .error-code {
                        font-family: monospace;
                        background: #f1f1f1;
                        padding: 8px;
                        border-radius: 4px;
                        margin: 10px 0;
                    }
                    .btn {
                        background: #007bff;
                        color: white;
                        padding: 12px 24px;
                        border: none;
                        border-radius: 6px;
                        cursor: pointer;
                        font-size: 16px;
                        margin: 10px;
                        text-decoration: none;
                        display: inline-block;
                    }
                    .btn:hover {
                        background: #0056b3;
                    }
                    .btn-secondary {
                        background: #6c757d;
                    }
                    .btn-secondary:hover {
                        background: #545b62;
                    }
                    .troubleshooting {
                        text-align: left;
                        margin-top: 20px;
                        padding: 20px;
                        background: #f8f9fa;
                        border-radius: 8px;
                    }
                </style>
            </t>

            <div class="container">
                <div class="error-icon">❌</div>
                <h1>Connection Failed</h1>
                <p>There was an error connecting your Odoo system to Zid.</p>

                <div class="error-details">
                    <h3>Error Details</h3>
                    <div class="error-code">
                        <strong>Error:</strong> <span t-esc="error" t-if="error"/>
                    </div>
                    <p t-if="error_description"><span t-esc="error_description"/></p>
                </div>

                <div class="troubleshooting">
                    <h3>Troubleshooting Steps</h3>
                    <ul>
                        <li>Check that your Client ID and Client Secret are correct</li>
                        <li>Verify that the Redirect URL matches exactly in Zid Partner Dashboard</li>
                        <li>Ensure you have the necessary permissions in Zid</li>
                        <li>Try refreshing the page and attempting the connection again</li>
                        <li>Contact your system administrator if the problem persists</li>
                    </ul>
                </div>

                <button class="btn btn-secondary" onclick="window.close()">Close Window</button>
                <button class="btn" onclick="window.history.back()">Try Again</button>
            </div>

            <script type="text/javascript">
                // Try to notify parent window of error if possible
                try {
                    if (window.opener &amp;&amp; !window.opener.closed) {
                        console.log('OAuth error occurred');
                    }
                } catch (e) {
                    console.log('Could not communicate with parent window');
                }
            </script>
        </t>
    </template>
</odoo>
